<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥‡ç¾å“è³ªå­¸è‹‘ - å­¸ç¿’ç®¡ç†ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: #2d3748;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 60px;
            height: 60px;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xMDAgMjBMMTgwIDYwVjE0MEwxMDAgMTgwTDIwIDE0MFY2MEwxMDAgMjBaIiBmaWxsPSIjRkJCRjI0IiBzdHJva2U9IiMxRTQwQUYiIHN0cm9rZS13aWR0aD0iNCIvPgo8Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjMwIiBmaWxsPSIjMUU0MEFGIi8+CjxwYXRoIGQ9Ik0xMDAgODBMMTIwIDEwMEwxMDAgMTIwTDgwIDEwMEwxMDAgODBaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4=');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            border-radius: 8px;
        }

        .brand-info h1 {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .brand-values {
            font-size: 0.9em;
            opacity: 0.9;
            font-style: italic;
        }

        /* Navigation */
        .nav-tabs {
            background: #f8fafc;
            border-bottom: 2px solid #e2e8f0;
            padding: 0;
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
        }

        .nav-tab {
            padding: 15px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #64748b;
        }

        .nav-tab:hover {
            background: #e2e8f0;
            color: #1e40af;
        }

        .nav-tab.active {
            background: white;
            color: #1e40af;
            border-bottom-color: #1e40af;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }

        .card h2 {
            color: #1e40af;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 10px;
        }

        /* Course Cards */
        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .course-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .course-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .course-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .course-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            margin-right: 15px;
        }

        .course-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #1e40af;
        }

        .course-meta {
            font-size: 0.9em;
            color: #6b7280;
            margin-bottom: 15px;
        }

        .course-description {
            color: #374151;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .course-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 500;
        }

        .status-available {
            background: #dcfce7;
            color: #166534;
        }

        .status-completed {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-in-progress {
            background: #fef3c7;
            color: #92400e;
        }

        /* Learning History */
        .history-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .history-title {
            font-weight: 600;
            color: #1e40af;
        }

        .history-date {
            font-size: 0.9em;
            color: #6b7280;
        }

        .history-score {
            font-size: 1.1em;
            font-weight: bold;
        }

        .score-excellent {
            color: #16a34a;
        }

        .score-good {
            color: #f59e0b;
        }

        .score-needs-improvement {
            color: #dc2626;
        }

        /* Quiz Layout */
        .quiz-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
            margin-top: 30px;
        }

        .quiz-main {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }

        .quiz-sidebar {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        /* AI Chat Box */
        .ai-chat-box {
            border: 2px solid #3b82f6;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .ai-chat-header {
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            color: white;
            padding: 15px;
            border-radius: 10px 10px 0 0;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ai-chat-content {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .chat-messages {
            margin-bottom: 15px;
            max-height: 250px;
            overflow-y: auto;
        }

        .chat-message {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 10px;
            max-width: 85%;
        }

        .chat-message.user {
            background: #eff6ff;
            border: 1px solid #dbeafe;
            margin-left: auto;
            text-align: right;
        }

        .chat-message.ai {
            background: #f0fdf4;
            border: 1px solid #dcfce7;
            margin-right: auto;
        }

        .chat-input-area {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .chat-send-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .chat-send-btn:hover {
            background: #2563eb;
        }

        /* Question Components */
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .question-number {
            background: #3b82f6;
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.1em;
        }

        .question-type {
            color: #6b7280;
            font-size: 0.9em;
            background: #f3f4f6;
            padding: 8px 16px;
            border-radius: 20px;
        }

        .scenario-box {
            background: linear-gradient(135deg, #fef7ff 0%, #fae8ff 100%);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #a855f7;
        }

        .scenario-box h4 {
            color: #7c3aed;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .question-text {
            font-size: 1.1em;
            line-height: 1.7;
            margin-bottom: 25px;
            color: #374151;
            font-weight: 500;
        }

        .options {
            display: grid;
            gap: 15px;
        }

        .option {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            padding: 18px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            line-height: 1.5;
        }

        .option:hover {
            background: #eff6ff;
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.15);
        }

        .option.selected {
            background: #dbeafe;
            border-color: #3b82f6;
        }

        .option.correct {
            background: #dcfce7;
            border-color: #16a34a;
            color: #166534;
        }

        .option.incorrect {
            background: #fef2f2;
            border-color: #dc2626;
            color: #991b1b;
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Visual Aid Section */
        .visual-aid {
            background: #f8fafc;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            border: 1px solid #e2e8f0;
        }

        .visual-aid h4 {
            color: #374151;
            margin-bottom: 15px;
            text-align: center;
        }

        .monitor-display {
            background: #1f2937;
            color: #10b981;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
        }

        .monitor-line {
            margin: 8px 0;
            font-size: 1.1em;
        }

        .team-roles {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .role-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .role-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }

        .role-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .role-title {
            font-weight: bold;
            color: #1e40af;
            margin-bottom: 8px;
        }

        .safety-alert {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
            border: 2px solid #ef4444;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .safety-alert h4 {
            color: #dc2626;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .highlight-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 1px solid #f59e0b;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .highlight-box h4 {
            color: #92400e;
            margin-bottom: 10px;
        }

        /* Objectives */
        .objectives {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #10b981;
        }

        .objectives h4 {
            color: #065f46;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .objectives ul {
            list-style: none;
            padding-left: 0;
        }

        .objectives li {
            padding: 8px 0;
            padding-left: 30px;
            position: relative;
            color: #374151;
        }

        .objectives li::before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #10b981;
            font-weight: bold;
            font-size: 1.2em;
        }

        /* Buttons */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 8px;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(22, 163, 74, 0.4);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .modal-icon {
            font-size: 2.5em;
            margin-right: 15px;
        }

        .modal-title {
            font-size: 1.8em;
            font-weight: bold;
        }

        .modal-title.correct {
            color: #16a34a;
        }

        .modal-title.incorrect {
            color: #dc2626;
        }

        .modal-text {
            line-height: 1.8;
            margin-bottom: 25px;
            color: #374151;
        }

        .modal-reference {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #6b7280;
            font-size: 0.9em;
            color: #4b5563;
        }

        /* Credit Registration Modal */
        .credit-modal {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border: 2px solid #16a34a;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
        }

        .credit-modal h3 {
            color: #166534;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Results Section */
        .results-section {
            display: none;
            text-align: center;
        }

        .score-display {
            font-size: 2em;
            margin: 30px 0;
            padding: 30px;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-radius: 20px;
            border: 2px solid #3b82f6;
        }

        .score-display.excellent {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border-color: #16a34a;
            color: #166534;
        }

        .score-display.good {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-color: #f59e0b;
            color: #92400e;
        }

        .score-display.needs-improvement {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
            border-color: #dc2626;
            color: #991b1b;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .nav-content {
                flex-direction: column;
            }

            .nav-tab {
                text-align: center;
            }

            .container {
                padding: 0 15px;
            }

            .card {
                padding: 20px;
                margin-bottom: 20px;
            }

            .quiz-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .quiz-sidebar {
                order: -1;
                position: static;
            }

            .course-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 10% auto;
                padding: 25px;
                width: 95%;
            }
        }

        /* Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .quiz-main {
            animation: fadeInUp 0.6s ease-out;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo"></div>
                <div class="brand-info">
                    <h1>å¥‡ç¾å“è³ªå­¸è‹‘</h1>
                    <div class="brand-values">äººæœ¬ â€¢ å‰µæ–° â€¢ å“è¶Š</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <div class="nav-tabs">
        <div class="nav-content">
            <div class="nav-tab active" onclick="showTab('home')">ğŸ“š å­¸ç¿’æ¡ˆä¾‹åˆ—è¡¨</div>
            <div class="nav-tab" onclick="showTab('progress')">ğŸ“Š å€‹äººå­¸ç¿’æ­·ç¨‹</div>
        </div>
    </div>

    <div class="container">
        <!-- Home Tab (Course List) -->
        <div id="homeTab" class="tab-content active">
            <div class="card">
                <h2>ğŸ“š å­¸ç¿’æ¡ˆä¾‹åˆ—è¡¨</h2>
                <p style="margin-bottom: 30px;">æ­¡è¿ä¾†åˆ°å¥‡ç¾å“è³ªå­¸è‹‘ï¼é¸æ“‡æ‚¨æƒ³è¦å­¸ç¿’çš„æ¡ˆä¾‹ï¼Œé€éäº’å‹•å¼æƒ…å¢ƒæ¨¡æ“¬ï¼Œæå‡å°ˆæ¥­æŠ€èƒ½ã€‚</p>
                
                <div class="course-grid">
                    <div class="course-card" onclick="startCourse('niv')">
                        <div class="course-header">
                            <div class="course-icon">ğŸ«</div>
                            <div>
                                <div class="course-title">éä¾µè¥²æ€§å‘¼å¸å™¨ (NIV) é†«ç™‚åœ˜éšŠç…§è­·å­¸ç¿’</div>
                                <div class="course-meta">å‘¼å¸æ²»ç™‚ â€¢ TRMæ‡‰ç”¨ â€¢ 8é¡Œæ¸¬é©— â€¢ åŠæ ¼åˆ†æ•¸ï¼š80åˆ†</div>
                            </div>
                        </div>
                        <div class="course-description">
                            é€éCOPDç—…äººçš„ç…§è­·æƒ…å¢ƒï¼Œå­¸ç¿’NIVåœ˜éšŠç…§è­·ç®¡ç†ã€TRMå·¥å…·æ‡‰ç”¨ã€å®‰å…¨è­°é¡Œè™•ç†ç­‰æ ¸å¿ƒæŠ€èƒ½ã€‚åŒ…å«SBARæºé€šã€é›™é‡ç¢ºèªã€CUSé—œåˆ‡è¡¨é”ç­‰å¯¦å‹™æ‡‰ç”¨ã€‚
                        </div>
                        <div class="course-status">
                            <div class="status-badge status-available">å¯é–‹å§‹å­¸ç¿’</div>
                            <div style="font-size: 0.9em; color: #6b7280;">ç´„éœ€ 45 åˆ†é˜</div>
                        </div>
                    </div>

                    <div class="course-card" style="opacity: 0.6; cursor: not-allowed;">
                        <div class="course-header">
                            <div class="course-icon">ğŸ’Š</div>
                            <div>
                                <div class="course-title">è—¥ç‰©å®‰å…¨ç®¡ç†</div>
                                <div class="course-meta">ç”¨è—¥å®‰å…¨ â€¢ é¢¨éšªç®¡ç† â€¢ å³å°‡æ¨å‡º</div>
                            </div>
                        </div>
                        <div class="course-description">
                            å­¸ç¿’è—¥ç‰©ä½¿ç”¨å®‰å…¨ã€ä¸è‰¯äº‹ä»¶è™•ç†ã€åœ˜éšŠæºé€šç­‰é—œéµæŠ€èƒ½ï¼Œæå‡ç”¨è—¥å®‰å…¨å“è³ªã€‚
                        </div>
                        <div class="course-status">
                            <div class="status-badge" style="background: #f3f4f6; color: #6b7280;">å³å°‡æ¨å‡º</div>
                            <div style="font-size: 0.9em; color: #6b7280;">é–‹ç™¼ä¸­</div>
                        </div>
                    </div>

                    <div class="course-card" style="opacity: 0.6; cursor: not-allowed;">
                        <div class="course-header">
                            <div class="course-icon">ğŸš¨</div>
                            <div>
                                <div class="course-title">ç·Šæ€¥æ‡‰è®Šè™•ç†</div>
                                <div class="course-meta">æ€¥æ•‘æŠ€èƒ½ â€¢ åœ˜éšŠåˆä½œ â€¢ å³å°‡æ¨å‡º</div>
                            </div>
                        </div>
                        <div class="course-description">
                            ç·Šæ€¥ç‹€æ³ä¸‹çš„åœ˜éšŠå”ä½œã€æ€¥æ•‘æŠ€èƒ½æ‡‰ç”¨ã€å±æ©Ÿè™•ç†ç­‰æ ¸å¿ƒèƒ½åŠ›åŸ¹é¤Šã€‚
                        </div>
                        <div class="course-status">
                            <div class="status-badge" style="background: #f3f4f6; color: #6b7280;">å³å°‡æ¨å‡º</div>
                            <div style="font-size: 0.9em; color: #6b7280;">é–‹ç™¼ä¸­</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Tab -->
        <div id="progressTab" class="tab-content">
            <div class="card">
                <h2>ğŸ“Š å€‹äººå­¸ç¿’æ­·ç¨‹</h2>
                <div id="progressContent">
                    <p style="color: #6b7280; text-align: center; margin: 40px 0;">
                        å°šç„¡å­¸ç¿’è¨˜éŒ„ï¼Œè«‹å…ˆå®Œæˆå­¸ç¿’æ¡ˆä¾‹ä»¥å»ºç«‹å­¸ç¿’æ­·ç¨‹ã€‚
                    </p>
                </div>
            </div>
        </div>

        <!-- NIV Course Content -->
        <div id="nivCourse" style="display: none;">
            <!-- Course Introduction -->
            <div class="card" id="courseIntro">
                <h2>ğŸ« éä¾µè¥²æ€§å‘¼å¸å™¨ (NIV) é†«ç™‚åœ˜éšŠç…§è­·å­¸ç¿’</h2>
                <p style="font-size: 1.1em; margin-bottom: 25px;">
                    æœ¬èª²ç¨‹é€éä¸€ä½COPDç—…äººçš„å®Œæ•´ç…§è­·æ­·ç¨‹ï¼Œå¼•å°æ‚¨æ·±å…¥äº†è§£éä¾µè¥²æ€§å‘¼å¸å™¨çš„åœ˜éšŠç…§è­·ç®¡ç†ã€‚èª²ç¨‹ç‰¹åˆ¥å¼·èª¿TRMå·¥å…·çš„å¯¦éš›æ‡‰ç”¨ï¼ŒåŒ…å«SBARæºé€šã€é›™é‡ç¢ºèªã€CUSé—œåˆ‡è¡¨é”ç­‰æ ¸å¿ƒæŠ€èƒ½ã€‚
                </p>

                <div class="objectives">
                    <h4>ğŸ¯ å­¸ç¿’ç›®æ¨™</h4>
                    <ul>
                        <li>é‹ç”¨TRMå·¥å…·(SBARã€é–‰ç’°æºé€šã€å±æ€¥å€¼è™•ç†)æå‡åœ˜éšŠæ•ˆèƒ½</li>
                        <li>æŒæ¡NIVç…§è­·ä¸­çš„å®‰å…¨æª¢æ ¸æ¸…å–®(Safety Checklist)æ‡‰ç”¨</li>
                        <li>ç†Ÿæ‚‰éä¾µè¥²æ€§å‘¼å¸å™¨çš„é©æ‡‰ç—‡ã€ç¦å¿Œç—‡åŠé¢¨éšªè©•ä¼°</li>
                        <li>å¯¦è¸"é›™é‡ç¢ºèª"å’Œ"Read Back"ç­‰å®‰å…¨æ©Ÿåˆ¶</li>
                        <li>äº†è§£CUS(æˆ‘é—œåˆ‡ã€æˆ‘ä¸å®‰ã€æˆ‘å®³æ€•)æºé€šæ¨¡å¼åœ¨ç·Šæ€¥ç‹€æ³çš„æ‡‰ç”¨</li>
                        <li>æŒæ¡é€²é£Ÿæ™‚é–‹é—œæ©Ÿçš„å®‰å…¨æ¨™æº–ä½œæ¥­ç¨‹åº(SOP)</li>
                        <li>é‹ç”¨RCA(æ ¹æœ¬åŸå› åˆ†æ)æ€ç¶­é é˜²ä½µç™¼ç—‡</li>
                    </ul>
                </div>

                <div class="highlight-box">
                    <h4>ğŸ’¡ TRMæ ¸å¿ƒç†å¿µ</h4>
                    <p><strong>"äººæœ¬ã€å‰µæ–°ã€å“è¶Š"</strong> - é€éç³»çµ±åŒ–çš„åœ˜éšŠè³‡æºç®¡ç†ï¼Œæˆ‘å€‘è‡´åŠ›æ–¼ï¼š</p>
                    <ul style="text-align: left; margin-top: 10px;">
                        <li>ğŸ›¡ï¸ <strong>é›¶å‚·å®³ç›®æ¨™</strong>ï¼šé é˜²æ‰€æœ‰å¯é¿å…çš„å‚·å®³</li>
                        <li>ğŸ¤ <strong>æœ‰æ•ˆæºé€š</strong>ï¼šé‹ç”¨çµæ§‹åŒ–æºé€šå·¥å…·</li>
                        <li>âš¡ <strong>å³æ™‚æ‡‰è®Š</strong>ï¼šå»ºç«‹å¿«é€Ÿåæ‡‰æ©Ÿåˆ¶</li>
                        <li>ğŸ“Š <strong>æŒçºŒæ”¹å–„</strong>ï¼šå¾æ¯å€‹æ¡ˆä¾‹ä¸­å­¸ç¿’æˆé•·</li>
                    </ul>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="startLearning()">é–‹å§‹å­¸ç¿’</button>
                    <button class="btn" onclick="backToHome()" style="background: #6b7280; color: white;">è¿”å›èª²ç¨‹åˆ—è¡¨</button>
                </div>
            </div>

            <!-- Case Background -->
            <div class="card" id="caseBackground" style="display: none;">
                <h2>ğŸ“‹ æ¡ˆä¾‹èƒŒæ™¯</h2>
                
                <div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4>ğŸ‘¨â€âš•ï¸ ç—…äººè³‡è¨Š</h4>
                    <p><strong>é™³å…ˆç”Ÿï¼Œ75æ­²ç”·æ€§</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>æ—¢å¾€ç—…å²ï¼šæ…¢æ€§é˜»å¡æ€§è‚ºç–¾ç—…(COPD)</li>
                        <li>ä¸»è¨´ï¼šå‘¼å¸å›°é›£åŠ åŠ‡ã€è¡€æ°§é£½å’Œåº¦ä¸‹é™</li>
                        <li>å…¥é™¢åŸå› ï¼šæ€¥æ€§å‘¼å¸è¡°ç«­</li>
                        <li>ç›®å‰ç‹€æ³ï¼šå°šæœªé”åˆ°æ’ç®¡ç¨‹åº¦ï¼Œè€ƒæ…®ä½¿ç”¨BiPAPæ²»ç™‚</li>
                    </ul>
                </div>

                <div class="safety-alert">
                    <h4>âš ï¸ TRMå®‰å…¨æ€ç¶­</h4>
                    <p>åœ¨é€™å€‹è¤‡é›œæ¡ˆä¾‹ä¸­ï¼Œé†«ç™‚åœ˜éšŠéœ€è¦é‹ç”¨å¤šç¨®TRMå·¥å…·ï¼š<strong>SBARæºé€šã€é›™é‡ç¢ºèªã€å®‰å…¨æª¢æ ¸æ¸…å–®ã€CUSè¡¨é”é—œåˆ‡</strong>ï¼Œä¸¦éµå¾ªå¥‡ç¾é†«é™¢çš„å®‰å…¨æ–‡åŒ–ï¼š<strong>"ä»»ä½•äººéƒ½å¯ä»¥ç‚ºäº†ç—…äººå®‰å…¨è€Œæš«åœç¨‹åº"</strong>ã€‚</p>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="startQuiz()">é–‹å§‹æ¸¬é©—</button>
                    <button class="btn" onclick="backToIntro()" style="background: #6b7280; color: white;">è¿”å›èª²ç¨‹ä»‹ç´¹</button>
                </div>
            </div>

            <!-- Quiz Section -->
            <div id="quizSection" style="display: none;">
                <div class="quiz-layout">
                    <div class="quiz-main" id="questionCard">
                        <!-- Question content will be inserted here -->
                    </div>
                    
                    <div class="quiz-sidebar">
                        <!-- AI Chat Box -->
                        <div class="ai-chat-box">
                            <div class="ai-chat-header">
                                ğŸ¤– AI å­¸ç¿’å°è©±æ¡†
                            </div>
                            <div class="ai-chat-content">
                                <div class="chat-messages" id="chatMessages">
                                    <div class="chat-message ai">
                                        æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„AIå­¸ç¿’åŠ©æ‰‹ã€‚å¦‚æœæ‚¨å°é€™é“é¡Œç›®æœ‰ä»»ä½•ç–‘å•ï¼Œæˆ–æƒ³äº†è§£æ›´å¤šç›¸é—œçŸ¥è­˜ï¼Œè«‹éš¨æ™‚æå•ï¼
                                    </div>
                                </div>
                                <div class="chat-input-area">
                                    <input type="text" class="chat-input" id="chatInput" placeholder="è¼¸å…¥æ‚¨çš„å•é¡Œ..." onkeypress="handleChatKeyPress(event)">
                                    <button class="chat-send-btn" onclick="sendChatMessage()">ç™¼é€</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Progress Info -->
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #374151; margin-bottom: 10px;">ğŸ“Š å­¸ç¿’é€²åº¦</h4>
                            <div id="progressInfo">å•é¡Œ 1 / 8</div>
                            <div style="margin-top: 10px; font-size: 0.9em; color: #6b7280;">
                                åŠæ ¼åˆ†æ•¸ï¼š80åˆ† (7é¡Œä»¥ä¸Š)
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="card results-section" id="resultsSection">
                <h2>ğŸ“Š å­¸ç¿’æˆæœ</h2>
                <div class="score-display" id="scoreDisplay">
                    <!-- Score will be displayed here -->
                </div>
                <div id="resultsContent">
                    <!-- Results content will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-icon" id="modalIcon">âœ…</span>
                <span class="modal-title" id="modalTitle">å›é¥‹</span>
            </div>
            <div class="modal-text" id="modalText">å›é¥‹å…§å®¹</div>
            <div class="modal-reference" id="modalReference"></div>
            <div style="text-align: center;">
                <button class="btn btn-primary" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
            </div>
        </div>
    </div>

    <!-- Credit Registration Modal -->
    <div id="creditModal" class="modal">
        <div class="modal-content credit-modal">
            <h3>ğŸ‰ æ­å–œé€šéæ¸¬é©—ï¼</h3>
            <p style="margin-bottom: 25px;">æ‚¨å·²é”åˆ°åŠæ ¼æ¨™æº–ï¼Œå¯ä»¥ç”³è«‹å­¸åˆ†èªè­‰</p>
            
            <div class="form-group">
                <label for="creditEmployeeId">è«‹è¼¸å…¥æ‚¨çš„äººäº‹è™Ÿç¢¼ä»¥ç™»éŒ„å­¸åˆ†ï¼š</label>
                <input type="text" id="creditEmployeeId" placeholder="ä¾‹å¦‚ï¼šA12345" maxlength="10" required>
            </div>
            
            <div style="text-align: center;">
                <button class="btn btn-success" onclick="submitCredit()">ç™»éŒ„å­¸åˆ†</button>
                <button class="btn" onclick="skipCredit()" style="background: #6b7280; color: white;">æš«ä¸ç™»éŒ„</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨åŸŸè®Šæ•¸
        let currentQuestion = 0;
        let score = 0;
        let answers = [];
        let learningHistory = JSON.parse(localStorage.getItem('learningHistory')) || {};

        // é¡Œç›®è³‡æ–™
        const quizData = [
            {
                id: 1,
                type: "TRMå·¥å…·ï¼šSBARæºé€šæ¨¡å¼",
                scenario: "å¤œç­è­·ç†å¸«ç‹å°å§åœ¨23:00ç™¼ç¾é™³å…ˆç”ŸSpO2å¾92%é™è‡³85%ï¼Œå‘¼å¸æ€¥ä¿ƒï¼Œé¢ç½©å‘¨åœæœ‰å¤§é‡æ¼æ°£è²ã€‚å¥¹éœ€è¦ç«‹å³é€šçŸ¥å€¼ç­é†«å¸«ã€‚",
                question: "æ ¹æ“šTRMçš„SBARæºé€šæ¨¡å¼ï¼Œç‹å°å§æ‡‰è©²å¦‚ä½•æœ‰æ•ˆåœ°å‘é†«å¸«å ±å‘Šï¼Ÿè«‹é¸å‡ºæœ€å®Œæ•´ä¸”ç¬¦åˆSBARæ¶æ§‹çš„å ±å‘Šæ–¹å¼ï¼š",
                options: [
                    "A. ã€Œé†«å¸«ï¼Œé™³å…ˆç”Ÿçš„è¡€æ°§æ‰äº†ï¼Œä½ è¦ä¸è¦ä¾†çœ‹ä¸€ä¸‹ï¼Ÿã€",
                    "B. ã€ŒS-é™³å…ˆç”Ÿç›®å‰åœ¨ä½¿ç”¨BiPAPï¼›B-SpO2å¾92%é™è‡³85%ï¼Œé¢ç½©æ¼æ°£ï¼›A-æˆ‘èªç‚ºå¯èƒ½éœ€è¦èª¿æ•´é¢ç½©æˆ–è©•ä¼°æ˜¯å¦éœ€è¦æ’ç®¡ï¼›R-è«‹æ‚¨è©•ä¼°ä¸¦æŒ‡ç¤ºä¸‹ä¸€æ­¥è™•ç½®ã€",
                    "C. ã€Œé™³å…ˆç”Ÿè¡€æ°§é™åˆ°85%ï¼Œé¢ç½©åœ¨æ¼æ°£ï¼Œæˆ‘å·²ç¶“èª¿æ•´éäº†ä½†æ²’æ”¹å–„ã€",
                    "D. ã€Œé†«å¸«ï¼Œå¯èƒ½éœ€è¦å¹«é™³å…ˆç”Ÿæ’ç®¡ï¼Œä»–çš„è¡€æ°§å¾ˆä½ã€"
                ],
                correct: 1,
                feedback: {
                    correct: "å„ªç§€ï¼é€™æ˜¯æ¨™æº–çš„SBARæºé€šæ¨¡å¼ã€‚S(Situation)-æ¸…æ¥šæè¿°ç—…äººç‹€æ³ï¼›B(Background)-æä¾›ç›¸é—œèƒŒæ™¯è³‡è¨Šï¼›A(Assessment)-è¡¨é”å°ˆæ¥­è©•ä¼°ï¼›R(Recommendation)-æå‡ºå…·é«”å»ºè­°ã€‚é€™ç¨®çµæ§‹åŒ–æºé€šå¯ä»¥å¤§å¹…é™ä½æºé€šéŒ¯èª¤ï¼Œæå‡ç—…äººå®‰å…¨ã€‚",
                    incorrect: "SBARæ˜¯TRMçš„æ ¸å¿ƒå·¥å…·ä¹‹ä¸€ã€‚æœ‰æ•ˆçš„æºé€šéœ€è¦çµæ§‹åŒ–ï¼šç‹€æ³(S)â†’èƒŒæ™¯(B)â†’è©•ä¼°(A)â†’å»ºè­°(R)ã€‚ç°¡å–®çš„æè¿°æˆ–ç›´æ¥ä¸‹çµè«–éƒ½å¯èƒ½é€ æˆèª¤è§£æˆ–å»¶èª¤è™•ç½®ã€‚"
                },
                reference: "TRMæ¨™æº–ï¼šSBARæºé€šæ¨¡å¼æ˜¯é†«ç™‚åœ˜éšŠé–“æºé€šçš„é»ƒé‡‘æ¨™æº–ï¼Œå¯æ¸›å°‘90%çš„æºé€šéŒ¯èª¤ã€‚å¥‡ç¾é†«é™¢è¦æ±‚æ‰€æœ‰å±æ€¥ç‹€æ³å¿…é ˆä½¿ç”¨SBARå ±å‘Šã€‚",
                visual: `
                    <div class="highlight-box">
                        <h4>ğŸ“ SBARæºé€šæ¶æ§‹</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #ef4444;">
                                <strong>S - Situation</strong><br>
                                ç›®å‰ç™¼ç”Ÿä»€éº¼äº‹ï¼Ÿ
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                                <strong>B - Background</strong><br>
                                ç›¸é—œèƒŒæ™¯è³‡è¨Š
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <strong>A - Assessment</strong><br>
                                æˆ‘çš„å°ˆæ¥­è©•ä¼°
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #16a34a;">
                                <strong>R - Recommendation</strong><br>
                                æˆ‘çš„å»ºè­°æˆ–éœ€æ±‚
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 2,
                type: "TRMå®‰å…¨æª¢æ ¸ï¼šé›™é‡ç¢ºèªæ©Ÿåˆ¶",
                scenario: "é†«å¸«é–‹ç«‹é†«å›‘èª¿æ•´BiPAPåƒæ•¸ï¼šIPAPå¾12èª¿è‡³16 cmH2Oï¼ŒEPAPç¶­æŒ5 cmH2Oã€‚å‘¼å¸æ²»ç™‚å¸«æå…ˆç”Ÿæº–å‚™åŸ·è¡Œèª¿æ•´ã€‚",
                question: "æ ¹æ“šå¥‡ç¾é†«é™¢çš„å®‰å…¨æª¢æ ¸æ¸…å–®ï¼Œåœ¨èª¿æ•´é—œéµåƒæ•¸å‰ï¼Œæå…ˆç”Ÿå¿…é ˆåŸ·è¡Œå“ªé …TRMå®‰å…¨æªæ–½ï¼Ÿ",
                options: [
                    "A. ç›´æ¥æŒ‰ç…§é†«å›‘èª¿æ•´åƒæ•¸ï¼Œå› ç‚ºé†«å¸«å·²ç¶“ç¢ºèªé",
                    "B. åŸ·è¡Œã€Œé›™é‡ç¢ºèªã€ï¼šèˆ‡å¦ä¸€ä½RTæ ¸å°é†«å›‘å…§å®¹ï¼ŒåŒæ™‚ä½¿ç”¨ã€ŒRead Backã€å‘é†«å¸«ç¢ºèªåƒæ•¸è®Šæ›´ï¼Œä¸¦è¨˜éŒ„ç¢ºèªæ™‚é–“åŠäººå“¡",
                    "C. åªè¦åœ¨è­·ç†è¨˜éŒ„ä¸Šè¨»è¨˜å³å¯",
                    "D. èª¿æ•´å¾Œé€šçŸ¥è­·ç†å¸«ç›£æ¸¬å³å¯"
                ],
                correct: 1,
                feedback: {
                    correct: "å®Œå…¨æ­£ç¢ºï¼é€™å±•ç¾äº†å¤šå±¤æ¬¡å®‰å…¨æ©Ÿåˆ¶ï¼šé›™é‡ç¢ºèªå¯é˜²æ­¢äººç‚ºéŒ¯èª¤ï¼ŒRead Backç¢ºä¿æºé€šæº–ç¢ºæ€§ï¼Œè¨˜éŒ„æä¾›å¯è¿½æº¯æ€§ã€‚ç ”ç©¶é¡¯ç¤ºï¼Œé€™å¥—æ©Ÿåˆ¶å¯æ¸›å°‘é†«ç™‚éŒ¯èª¤é”85%ï¼Œç¬¦åˆå¥‡ç¾é†«é™¢ã€Œé›¶å‚·å®³ã€çš„å®‰å…¨ç›®æ¨™ã€‚",
                    incorrect: "é—œéµåƒæ•¸èª¿æ•´æ¶‰åŠç—…äººç”Ÿå‘½å®‰å…¨ï¼Œéœ€è¦å¤šé‡å®‰å…¨æ©Ÿåˆ¶ã€‚å–®ä¸€ç¢ºèªä¸è¶³ä»¥é˜²ç¯„ç³»çµ±æ€§éŒ¯èª¤ï¼Œé€™æ­£æ˜¯TRMå¼·èª¿çš„ã€Œå†—é¤˜å®‰å…¨ç¶²ã€æ¦‚å¿µã€‚"
                },
                reference: "å¥‡ç¾é†«é™¢å®‰å…¨æ”¿ç­–ï¼šæ‰€æœ‰å½±éŸ¿ç—…äººç”Ÿå‘½å¾µè±¡çš„åƒæ•¸è®Šæ›´ï¼Œå¿…é ˆåŸ·è¡Œé›™é‡ç¢ºèªå’ŒRead Backï¼Œä¸¦è¨˜éŒ„æ–¼å®‰å…¨æª¢æ ¸è¡¨ä¸­ã€‚",
                visual: `
                    <div class="safety-alert">
                        <h4>ğŸ”’ é›™é‡ç¢ºèªå®‰å…¨æµç¨‹</h4>
                        <ol style="text-align: left; margin-top: 10px;">
                            <li><strong>ç¬¬ä¸€å±¤ï¼š</strong>æ ¸å°é†«å›‘å…§å®¹(äººå“¡A)</li>
                            <li><strong>ç¬¬äºŒå±¤ï¼š</strong>ç¨ç«‹é©—è­‰(äººå“¡B)</li>
                            <li><strong>ç¬¬ä¸‰å±¤ï¼š</strong>Read Backå‘é†«å¸«ç¢ºèª</li>
                            <li><strong>ç¬¬å››å±¤ï¼š</strong>è¨˜éŒ„ç¢ºèªæ™‚é–“èˆ‡äººå“¡</li>
                            <li><strong>ç¬¬äº”å±¤ï¼š</strong>åŸ·è¡Œå‰æœ€å¾Œæª¢æŸ¥</li>
                        </ol>
                        <p style="color: #dc2626; font-weight: bold; margin-top: 10px;">
                            ğŸ’¡ è¨˜ä½ï¼šã€Œå¤šä¸€æ¬¡ç¢ºèªï¼Œå°‘ä¸€æ¬¡é¢¨éšªã€
                        </p>
                    </div>
                `
            },
            {
                id: 3,
                type: "TRMå·¥å…·ï¼šCUSé—œåˆ‡è¡¨é”",
                scenario: "è³‡æ·±è­·ç†å¸«ç™¼ç¾æ–°é€²å‘¼å¸æ²»ç™‚å¸«æº–å‚™åœ¨ç—…äººé€²é£Ÿæ™‚åƒ…é¬†é–‹é¢ç½©æ‰£ç’°ï¼Œè€Œéå®Œå…¨ç§»é™¤é¢ç½©ä¸¦åœæ©Ÿã€‚å¥¹èªç‚ºé€™å¯èƒ½é€ æˆå—†å’³é¢¨éšªã€‚",
                question: "åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œè³‡æ·±è­·ç†å¸«æ‡‰è©²å¦‚ä½•é‹ç”¨CUS(Concern-Uncomfortable-Safety)æ¨¡å¼ä¾†è¡¨é”é—œåˆ‡ï¼Ÿ",
                options: [
                    "A. ç›´æ¥å‘Šè¨´RTï¼šã€Œä½ é€™æ¨£åšæ˜¯éŒ¯çš„ã€",
                    "B. ç§ä¸‹å‘ä¸»ç®¡å ±å‘Šé€™å€‹å•é¡Œ",
                    "C. ã€Œæˆ‘é—œåˆ‡(Concern)é€™å€‹åšæ³•å¯èƒ½å¢åŠ å—†å’³é¢¨éšªï¼›æˆ‘æ„Ÿåˆ°ä¸å®‰(Uncomfortable)å› ç‚ºç¨‹åºæ›¸è¦æ±‚å®Œå…¨ç§»é™¤ï¼›ç‚ºäº†å®‰å…¨(Safety)æˆ‘å€‘æ‡‰è©²æš«åœä¸¦é‡æ–°ç¢ºèªSOPã€",
                    "D. ç­‰åˆ°ç™¼ç”Ÿå•é¡Œå†è™•ç†"
                ],
                correct: 2,
                feedback: {
                    correct: "å„ªç§€çš„å®‰å…¨é ˜å°åŠ›ï¼CUSæ¨¡å¼æ˜¯TRMä¸­é é˜²éŒ¯èª¤çš„æœ‰åŠ›å·¥å…·ã€‚é€éçµæ§‹åŒ–çš„é—œåˆ‡è¡¨é”ï¼Œæ—¢ä¿è­·äº†ç—…äººå®‰å…¨ï¼Œåˆç¶­è­·äº†åŒäº‹é—œä¿‚ï¼Œä¸¦å‰µé€ äº†å­¸ç¿’æ©Ÿæœƒã€‚å¥‡ç¾é†«é™¢é¼“å‹µæ‰€æœ‰åŒä»å‹‡æ–¼è¡¨é”å®‰å…¨é—œåˆ‡ã€‚",
                    incorrect: "ç›´æ¥æ‰¹è©•ã€æ¶ˆæ¥µå ±å‘Šæˆ–ç­‰å¾…éƒ½ä¸æ˜¯æœ€ä½³çš„å®‰å…¨æ–‡åŒ–è¡¨ç¾ã€‚CUSæ¨¡å¼æä¾›äº†æ—¢å …å®šåˆå°Šé‡çš„é—œåˆ‡è¡¨é”æ–¹å¼ï¼Œæ˜¯é é˜²éŒ¯èª¤çš„é‡è¦å·¥å…·ã€‚"
                },
                reference: "TRMå®‰å…¨æ–‡åŒ–ï¼šä»»ä½•åœ˜éšŠæˆå“¡éƒ½æœ‰è²¬ä»»å’Œæ¬Šåˆ©ç‚ºäº†ç—…äººå®‰å…¨è€Œè¡¨é”é—œåˆ‡ï¼ŒCUSæ˜¯æ¨™æº–çš„è¡¨é”æ¨¡å¼ã€‚",
                visual: `
                    <div class="highlight-box">
                        <h4>ğŸ—£ï¸ CUSå®‰å…¨æºé€šæ¨¡å¼</h4>
                        <div style="display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 15px;">
                            <div style="background: #fef3c7; padding: 12px; border-radius: 6px; border-left: 4px solid #f59e0b;">
                                <strong>C - Concern (æˆ‘é—œåˆ‡)</strong><br>
                                å®¢è§€æè¿°è§€å¯Ÿåˆ°çš„æƒ…æ³
                            </div>
                            <div style="background: #fef2f2; padding: 12px; border-radius: 6px; border-left: 4px solid #ef4444;">
                                <strong>U - Uncomfortable (æˆ‘ä¸å®‰)</strong><br>
                                è¡¨é”å…§å¿ƒçš„å°ˆæ¥­æ“”æ†‚
                            </div>
                            <div style="background: #dcfce7; padding: 12px; border-radius: 6px; border-left: 4px solid #16a34a;">
                                <strong>S - Safety (å®‰å…¨åœæ­¢)</strong><br>
                                æå‡ºå…·é«”çš„å®‰å…¨å»ºè­°
                            </div>
                        </div>
                        <p style="text-align: center; margin-top: 15px; font-weight: bold; color: #1e40af;">
                            "æ¯å€‹äººéƒ½æ˜¯å®‰å…¨å®ˆè­·è€…"
                        </p>
                    </div>
                `
            },
            {
                id: 4,
                type: "è¤‡é›œæƒ…å¢ƒï¼šå¤šé‡å®‰å…¨å¨è„…è­˜åˆ¥",
                scenario: "å‡Œæ™¨2é»ï¼Œé™³å…ˆç”ŸåŒæ™‚å‡ºç¾ï¼š(1)SpO2é™è‡³82% (2)BiPAPé¡¯ç¤ºé«˜å£“è­¦å ± (3)ç—…äººèºå‹•ä¸å®‰ (4)é¢ç½©å‘¨åœæœ‰è¡€è·¡ (5)å®¶å±¬è¦æ±‚ç«‹å³é€²é£Ÿã€‚å€¼ç­è­·ç†å¸«é¢è‡¨å¤šé‡å®‰å…¨å¨è„…ã€‚",
                question: "æ ¹æ“šTRMçš„å¨è„…è­˜åˆ¥å’Œå„ªå…ˆåºç®¡ç†åŸå‰‡ï¼Œè­·ç†å¸«æ‡‰è©²æ¡å–ä»€éº¼è¡Œå‹•åºåˆ—ï¼Ÿ",
                options: [
                    "A. ç«‹å³æ»¿è¶³å®¶å±¬è¦æ±‚ï¼Œè®“ç—…äººé€²é£Ÿä»¥ç·©è§£èºå‹•",
                    "B. æŒ‰ç…§ABC+å®‰å…¨åŸå‰‡ï¼šå…ˆç¢ºä¿æ°£é“æš¢é€š(A)â†’è©•ä¼°å‘¼å¸å¾ªç’°(BC)â†’è™•ç†è¨­å‚™è­¦å ±â†’å®‰æ’«ç—…äººâ†’èˆ‡å®¶å±¬æºé€šé¢¨éšª",
                    "C. å…ˆè™•ç†è¨­å‚™è­¦å ±ï¼Œå†è©•ä¼°ç—…äººç‹€æ³",
                    "D. ç«‹å³é€šçŸ¥é†«å¸«ï¼Œç­‰å€™æŒ‡ç¤º"
                ],
                correct: 1,
                feedback: {
                    correct: "å“è¶Šçš„å±æ©Ÿè™•ç†ï¼æ‚¨æ­£ç¢ºé‹ç”¨äº†TRMçš„å¨è„…ç®¡ç†éšå±¤ï¼šç”Ÿå‘½å„ªå…ˆ(ABC)â†’è¨­å‚™å®‰å…¨â†’ç—…äººèˆ’é©â†’å®¶å±¬æºé€šã€‚é¢ç½©å‘¨åœè¡€è·¡å¯èƒ½è¡¨ç¤ºå£“å‚·æˆ–é¼»å‡ºè¡€ï¼Œé«˜å£“è­¦å ±é…åˆä½è¡€æ°§æç¤ºå‘¼å¸é“é˜»å¡æˆ–è¨­å‚™æ•…éšœï¼Œé€™äº›éƒ½æ˜¯ç«‹å³å¨è„…ã€‚",
                    incorrect: "åœ¨å¤šé‡å¨è„…æƒ…å¢ƒä¸‹ï¼Œéœ€è¦ç³»çµ±æ€§çš„å„ªå…ˆåºåˆ¤æ–·ã€‚TRMå¼·èª¿ABC+å®‰å…¨åŸå‰‡ï¼šå…ˆè™•ç†å¨è„…ç”Ÿå‘½çš„å•é¡Œï¼Œå†è™•ç†æ¬¡è¦å•é¡Œã€‚"
                },
                reference: "TRMå±æ©Ÿç®¡ç†ï¼šè¤‡é›œæƒ…å¢ƒä¸‹çš„ABCDEè©•ä¼°æ³• - Airway, Breathing, Circulation, Disability, Exposure + Safety measuresã€‚",
                visual: `
                    <div class="safety-alert">
                        <h4>ğŸš¨ å¤šé‡å¨è„…è™•ç†åºåˆ—</h4>
                        <div style="display: grid; grid-template-columns: 1fr; gap: 8px; margin-top: 15px;">
                            <div style="background: #dc2626; color: white; padding: 10px; border-radius: 6px;">
                                <strong>ç¬¬1å„ªå…ˆï¼š</strong>æ°£é“è©•ä¼° - æª¢æŸ¥è¡€è·¡ä¾†æº
                            </div>
                            <div style="background: #ea580c; color: white; padding: 10px; border-radius: 6px;">
                                <strong>ç¬¬2å„ªå…ˆï¼š</strong>å‘¼å¸æ”¯æŒ - è™•ç†ä½è¡€æ°§
                            </div>
                            <div style="background: #d97706; color: white; padding: 10px; border-radius: 6px;">
                                <strong>ç¬¬3å„ªå…ˆï¼š</strong>è¨­å‚™æª¢æŸ¥ - è§£æ±ºé«˜å£“è­¦å ±
                            </div>
                            <div style="background: #65a30d; color: white; padding: 10px; border-radius: 6px;">
                                <strong>ç¬¬4å„ªå…ˆï¼š</strong>ç—…äººå®‰æ’« - è™•ç†èºå‹•
                            </div>
                            <div style="background: #0284c7; color: white; padding: 10px; border-radius: 6px;">
                                <strong>ç¬¬5å„ªå…ˆï¼š</strong>å®¶å±¬æºé€š - è§£é‡‹é¢¨éšª
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 5,
                type: "TRMå·¥å…·ï¼šé–‰ç’°æºé€šåœ¨ç·Šæ€¥ç‹€æ³",
                scenario: "é†«å¸«æ±ºå®šç·Šæ€¥æ’ç®¡ï¼Œä¸‹é”å£é ­é†«å›‘ï¼šã€Œæº–å‚™7.5è™Ÿæ°£ç®¡å…§ç®¡ï¼ŒEtomidate 0.3mg/kgï¼ŒRocuronium 1mg/kgï¼Œåœæ­¢BiPAPã€ã€‚è­·ç†å¸«éœ€è¦ç¢ºä¿æº–ç¢ºåŸ·è¡Œã€‚",
                question: "åœ¨é€™å€‹ç·Šæ€¥ç‹€æ³ä¸‹ï¼Œè­·ç†å¸«æ‡‰è©²å¦‚ä½•é‹ç”¨ã€Œé–‰ç’°æºé€šã€ç¢ºä¿ç—…äººå®‰å…¨ï¼Ÿ",
                options: [
                    "A. ç«‹å³åŸ·è¡Œé†«å›‘ï¼Œå› ç‚ºæƒ…æ³ç·Šæ€¥ä¸èƒ½è€½èª¤",
                    "B. ã€ŒRead Backã€ï¼šé‡è¤‡é†«å›‘å…§å®¹â†’ç²å¾—é†«å¸«ç¢ºèªâ†’åŸ·è¡Œâ†’å›å ±å®Œæˆâ†’é†«å¸«ç¢ºèªæ”¶åˆ°ï¼Œä¸¦è¨˜éŒ„å®Œæ•´æ™‚é–“è»¸",
                    "C. åªè¦é‡è¤‡ä¸€éé†«å›‘å…§å®¹å³å¯",
                    "D. åŸ·è¡Œå¾Œå†å‘é†«å¸«ç¢ºèª"
                ],
                correct: 1,
                feedback: {
                    correct: "å®Œç¾çš„ç·Šæ€¥ç‹€æ³TRMæ‡‰ç”¨ï¼é–‰ç’°æºé€šåœ¨å±æ€¥æ™‚åˆ»æ›´åŠ é‡è¦ï¼šéŒ¯èª¤çš„ä»£åƒ¹å¯èƒ½æ˜¯ç”Ÿå‘½ã€‚å®Œæ•´çš„é–‰ç’°åŒ…æ‹¬ï¼šæ¥æ”¶â†’ç¢ºèªâ†’åŸ·è¡Œâ†’å›å ±â†’å†ç¢ºèªï¼Œæ¯å€‹ç’°ç¯€éƒ½æœ‰æ™‚é–“è¨˜éŒ„ï¼Œç¢ºä¿å¯è¿½æº¯æ€§å’Œè²¬ä»»æ­¸å±¬ã€‚",
                    incorrect: "ç·Šæ€¥ç‹€æ³ä¸‹æ›´éœ€è¦ç²¾ç¢ºæºé€šï¼Œè€Œéçœç•¥æ­¥é©Ÿã€‚é–‰ç’°æºé€šé›–ç„¶éœ€è¦é¡å¤–å¹¾ç§’é˜ï¼Œä½†èƒ½é¿å…è‡´å‘½éŒ¯èª¤ï¼Œé€™æ­£æ˜¯TRMçš„æ ¸å¿ƒåƒ¹å€¼ã€‚"
                },
                reference: "ç·Šæ€¥é†«ç™‚TRMæ¨™æº–ï¼šè¶Šæ˜¯ç·Šæ€¥çš„æƒ…æ³ï¼Œè¶Šéœ€è¦çµæ§‹åŒ–æºé€šã€‚é–‰ç’°æºé€šå¯æ¸›å°‘ç·Šæ€¥ç‹€æ³ä¸‹çš„é†«ç™‚éŒ¯èª¤é”92%ã€‚",
                visual: `
                    <div class="monitor-display">
                        <div class="monitor-line">é–‰ç’°æºé€šæµç¨‹ï¼š</div>
                        <div class="monitor-line">1. é†«å¸«ä¸‹é”é†«å›‘ âœ“</div>
                        <div class="monitor-line">2. è­·ç†å¸«Read Back âœ“</div>
                        <div class="monitor-line">3. é†«å¸«ç¢ºèª âœ“</div>
                        <div class="monitor-line">4. è­·ç†å¸«åŸ·è¡Œ âœ“</div>
                        <div class="monitor-line">5. è­·ç†å¸«å›å ±å®Œæˆ âœ“</div>
                        <div class="monitor-line">6. é†«å¸«ç¢ºèªæ”¶åˆ° âœ“</div>
                        <div class="monitor-line">æ™‚é–“è¨˜éŒ„ï¼š00:00-00:45</div>
                    </div>
                `
            },
            {
                id: 6,
                type: "é€²éšå®‰å…¨ï¼šé€²é£Ÿæ™‚çš„å®‰å…¨æ¨™æº–ä½œæ¥­ç¨‹åº",
                scenario: "é™³å…ˆç”Ÿæ’ç®¡å¾Œç¬¬3å¤©é †åˆ©è„«ç®¡ï¼Œé‡æ–°ä½¿ç”¨BiPAPã€‚ç¾åœ¨ä»–è¦æ±‚é€²é£Ÿï¼Œä½†åŒæ™‚å‡ºç¾è¼•å¾®å‘¼å¸æ€¥ä¿ƒã€‚è­·ç†å¸«éœ€è¦è©•ä¼°é€²é£Ÿçš„å®‰å…¨æ€§ä¸¦åŸ·è¡ŒSOPã€‚",
                question: "æ ¹æ“šå¥‡ç¾é†«é™¢é€²é£Ÿå®‰å…¨æª¢æ ¸æ¸…å–®ï¼Œåœ¨å…è¨±ç—…äººé€²é£Ÿå‰ï¼Œè­·ç†å¸«å¿…é ˆå®Œæˆå“ªäº›è©•ä¼°é …ç›®ï¼Ÿï¼ˆé¸æ“‡æœ€å®Œæ•´çš„å®‰å…¨è©•ä¼°ï¼‰",
                options: [
                    "A. åªè¦ç—…äººæƒ³åƒå°±å¯ä»¥é€²é£Ÿ",
                    "B. æª¢æŸ¥SpO2>95%ã€RR<25ã€æ„è­˜æ¸…æ¥šã€ç„¡å—†å’³å²å³å¯é€²é£Ÿ",
                    "C. å®Œæ•´è©•ä¼°ï¼šSpO2â‰¥92%(room air 15åˆ†é˜)ã€å‘¼å¸å‹æ…‹ç©©å®šã€æ„è­˜E4M6V5ã€ååš¥åŠŸèƒ½æ­£å¸¸ã€å®¶å±¬åœ¨å ´ã€ç·Šæ€¥è¨­å‚™å‚™å¦¥ã€é†«å¸«åŒæ„ï¼Œä¸¦åŸ·è¡Œã€Œé€²é£Ÿå®‰å…¨æª¢æ ¸è¡¨ã€",
                    "D. é†«å¸«åŒæ„å³å¯é€²é£Ÿ"
                ],
                correct: 2,
                feedback: {
                    correct: "å„ªç§€çš„å®‰å…¨æ„è­˜ï¼é€™æ˜¯å®Œæ•´çš„é€²é£Ÿå®‰å…¨è©•ä¼°ã€‚ç‰¹åˆ¥æ³¨æ„ã€Œroom air 15åˆ†é˜ã€æ¸¬è©¦ï¼Œé€™å¯ä»¥ç¢ºä¿ç—…äººåœ¨æ²’æœ‰å‘¼å¸æ”¯æŒä¸‹çš„çœŸå¯¦ç‹€æ³ã€‚æ¯å€‹æª¢æ ¸é …ç›®éƒ½æœ‰å…¶å®‰å…¨è€ƒé‡ï¼Œé«”ç¾äº†ã€Œé é˜²å‹æ–¼æ²»ç™‚ã€çš„TRMç†å¿µã€‚",
                    incorrect: "é€²é£Ÿå°æ–¼å‰›è„«é›¢å‘¼å¸æ”¯æŒçš„ç—…äººæ˜¯é«˜é¢¨éšªæ´»å‹•ã€‚éœ€è¦å…¨é¢æ€§çš„å®‰å…¨è©•ä¼°ï¼Œå–®ä¸€æŒ‡æ¨™æˆ–ç°¡å–®è¨±å¯éƒ½ä¸è¶³ä»¥ç¢ºä¿å®‰å…¨ã€‚"
                },
                reference: "å¥‡ç¾é†«é™¢é€²é£Ÿå®‰å…¨SOPï¼šNIVç—…äººé€²é£Ÿå‰å¿…é ˆé€šéå¤šé …ç›®å®‰å…¨æª¢æ ¸ï¼Œç¢ºä¿é™ä½å—†å’³å’Œå‘¼å¸è¡°ç«­é¢¨éšªã€‚",
                visual: `
                    <div class="safety-alert">
                        <h4>ğŸ½ï¸ é€²é£Ÿå®‰å…¨æª¢æ ¸æ¸…å–®</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 15px;">
                            <div style="background: white; padding: 12px; border-radius: 6px; border: 1px solid #16a34a;">
                                <strong>ç”Ÿç†æŒ‡æ¨™</strong><br>
                                âœ“ SpO2â‰¥92% (room air 15min)<br>
                                âœ“ RR<25, å‘¼å¸ç©©å®š<br>
                                âœ“ è¡€å£“ç©©å®š
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 6px; border: 1px solid #3b82f6;">
                                <strong>åŠŸèƒ½è©•ä¼°</strong><br>
                                âœ“ æ„è­˜GCS E4M6V5<br>
                                âœ“ ååš¥åŠŸèƒ½æ¸¬è©¦<br>
                                âœ“ ç„¡å—†å’³å²
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 6px; border: 1px solid #f59e0b;">
                                <strong>ç’°å¢ƒæº–å‚™</strong><br>
                                âœ“ å®¶å±¬/ç…§è­·è€…åœ¨å ´<br>
                                âœ“ æŠ½ç—°è¨­å‚™å‚™å¦¥<br>
                                âœ“ ç·Šæ€¥è—¥ç‰©æº–å‚™
                            </div>
                            <div style="background: white; padding: 12px; border-radius: 6px; border: 1px solid #8b5cf6;">
                                <strong>åœ˜éšŠç¢ºèª</strong><br>
                                âœ“ é†«å¸«è©•ä¼°åŒæ„<br>
                                âœ“ RTç¢ºèªè¨­å‚™<br>
                                âœ“ ç‡Ÿé¤Šå¸«é£²é£Ÿå»ºè­°
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 7,
                type: "TRMå·¥å…·ï¼šRCAæ ¹æœ¬åŸå› åˆ†ææ€ç¶­",
                scenario: "é™³å…ˆç”Ÿåœ¨é€²é£Ÿå¾Œ30åˆ†é˜å‡ºç¾SpO2ä¸‹é™è‡³88%ï¼ŒXå…‰é¡¯ç¤ºå³ä¸‹è‚ºè‘‰æµ¸æ½¤ï¼Œæ‡·ç–‘å¸å…¥æ€§è‚ºç‚ã€‚åœ˜éšŠéœ€è¦é€²è¡Œäº‹ä»¶åˆ†æã€‚",
                question: "é‹ç”¨RCA(æ ¹æœ¬åŸå› åˆ†æ)çš„ç³»çµ±æ€ç¶­ï¼Œåœ˜éšŠæ‡‰è©²å¦‚ä½•åˆ†æé€™å€‹ä¸è‰¯äº‹ä»¶ï¼Ÿ",
                options: [
                    "A. èªå®šæ˜¯è­·ç†å¸«åˆ¤æ–·éŒ¯èª¤ï¼ŒåŠ å¼·å€‹äººè¨“ç·´å³å¯",
                    "B. èªç‚ºæ˜¯ç—…äººä¸é…åˆé€ æˆçš„æ„å¤–",
                    "C. ç³»çµ±æ€§åˆ†æï¼šæª¢è¦–é€²é£Ÿè©•ä¼°ç¨‹åºâ†’SOPåŸ·è¡Œå®Œæ•´æ€§â†’ç’°å¢ƒå› ç´ â†’æºé€šæµç¨‹â†’è¨­å‚™å› ç´ â†’äººå“¡èƒ½åŠ›â†’çµ„ç¹”å› ç´ ï¼Œæ‰¾å‡ºå¤šå±¤æ¬¡åŸå› ä¸¦æ”¹å–„ç³»çµ±",
                    "D. èªç‚ºæ˜¯é†«å¸«æ±ºç­–å•é¡Œ"
                ],
                correct: 2,
                feedback: {
                    correct: "å“è¶Šçš„ç³»çµ±æ€ç¶­ï¼RCAçš„ç²¾ç¥æ˜¯ã€Œè²¬æ€ªç³»çµ±è€Œéå€‹äººã€ã€‚é€éå¤šå±¤æ¬¡åˆ†æï¼Œæˆ‘å€‘å¯ä»¥ç™¼ç¾çœŸæ­£çš„ç³»çµ±å¼±é»ä¸¦æ”¹å–„ã€‚é€™å¯èƒ½åŒ…æ‹¬ï¼šæª¢æ ¸è¡¨è¨­è¨ˆã€äººå“¡è¨“ç·´ã€æºé€šæµç¨‹ã€ç’°å¢ƒå› ç´ ç­‰ã€‚çœŸæ­£çš„æ”¹å–„ä¾†è‡ªç³»çµ±å„ªåŒ–ï¼Œè€Œéå€‹äººè²¬é›£ã€‚",
                    incorrect: "RCAçš„æ ¸å¿ƒæ˜¯ç³»çµ±åˆ†æè€Œéå€‹äººè²¬é›£ã€‚ä¸è‰¯äº‹ä»¶é€šå¸¸æ˜¯å¤šå€‹å› ç´ äº¤äº’ä½œç”¨çš„çµæœï¼Œéœ€è¦æ·±å…¥åˆ†æç³»çµ±æ€§åŸå› æ‰èƒ½æœ‰æ•ˆé é˜²å†ç™¼ç”Ÿã€‚"
                },
                reference: "TRMå®‰å…¨æ–‡åŒ–ï¼šé‹ç”¨RCAé€²è¡Œç³»çµ±æ€§åˆ†æï¼Œå¾å€‹æ¡ˆä¸­å­¸ç¿’ä¸¦æ”¹å–„æ•´é«”ç…§è­·å“è³ªï¼Œé«”ç¾ã€ŒæŒçºŒæ”¹å–„ã€çš„æ ¸å¿ƒåƒ¹å€¼ã€‚",
                visual: `
                    <div class="highlight-box">
                        <h4>ğŸ” RCAåˆ†ææ¶æ§‹</h4>
                        <div style="margin-top: 15px;">
                            <div style="text-align: center; margin-bottom: 20px;">
                                <div style="background: #ef4444; color: white; padding: 10px; border-radius: 50%; width: 60px; height: 60px; margin: 0 auto; display: flex; align-items: center; justify-content: center; font-weight: bold;">äº‹ä»¶</div>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                <div style="background: #fef3c7; padding: 10px; border-radius: 6px; text-align: center;">
                                    <strong>ç›´æ¥åŸå› </strong><br>
                                    ç«‹å³è§¸ç™¼å› ç´ 
                                </div>
                                <div style="background: #dbeafe; padding: 10px; border-radius: 6px; text-align: center;">
                                    <strong>æ ¹æœ¬åŸå› </strong><br>
                                    ç³»çµ±æ€§å› ç´ 
                                </div>
                                <div style="background: #dcfce7; padding: 10px; border-radius: 6px; text-align: center;">
                                    <strong>è²¢ç»å› ç´ </strong><br>
                                    ç’°å¢ƒèˆ‡çµ„ç¹”
                                </div>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                id: 8,
                type: "TRMæ•´åˆï¼šé ˜å°åŠ›èˆ‡å®‰å…¨æ–‡åŒ–",
                scenario: "ç¶“éå®Œæ•´çš„RCAåˆ†æï¼Œåœ˜éšŠç™¼ç¾é€²é£Ÿå®‰å…¨æª¢æ ¸è¡¨æœ‰è¨­è¨ˆç¼ºé™·ï¼Œä¸”åœ˜éšŠé–“æºé€šå­˜åœ¨ç›²é»ã€‚èº«ç‚ºè³‡æ·±è­·ç†å¸«ï¼Œæ‚¨éœ€è¦æ¨å‹•æ”¹å–„æªæ–½ã€‚",
                question: "æ ¹æ“šTRMçš„é ˜å°åŠ›åŸå‰‡å’Œå¥‡ç¾é†«é™¢çš„å®‰å…¨æ–‡åŒ–ï¼Œæ‚¨æ‡‰è©²å¦‚ä½•æ¨å‹•ç³»çµ±æ€§æ”¹å–„ï¼Ÿ",
                options: [
                    "A. ä¿®æ”¹æª¢æ ¸è¡¨å³å¯ï¼Œå…¶ä»–ç¶­æŒç¾ç‹€",
                    "B. åªè¦åŠ å¼·äººå“¡è¨“ç·´å°±èƒ½è§£æ±ºå•é¡Œ",
                    "C. é‹ç”¨PDCAå¾ªç’°ï¼šPlan(é‡æ–°è¨­è¨ˆæª¢æ ¸è¡¨+æºé€šæµç¨‹)â†’Do(è©¦è¡Œæ–°åˆ¶åº¦)â†’Check(ç›£æ¸¬æˆæ•ˆæŒ‡æ¨™)â†’Action(æ¨™æº–åŒ–æœ€ä½³å¯¦å‹™)ï¼Œä¸¦å»ºç«‹ã€Œå­¸ç¿’å‹çµ„ç¹”ã€æ–‡åŒ–",
                    "D. ç­‰å¾…ä¸Šç´šæŒ‡ç¤ºå†è¡Œå‹•"
                ],
                correct: 2,
                feedback: {
                    correct: "å‚‘å‡ºçš„æ”¹å–„é ˜å°åŠ›ï¼æ‚¨å±•ç¾äº†TRMçš„æœ€é«˜å±¤æ¬¡ï¼šç³»çµ±æ”¹å–„å’Œæ–‡åŒ–å»ºæ§‹ã€‚PDCAå¾ªç’°ç¢ºä¿æ”¹å–„çš„ç§‘å­¸æ€§å’ŒæŒçºŒæ€§ï¼Œå­¸ç¿’å‹çµ„ç¹”æ–‡åŒ–è®“æ¯å€‹äº‹ä»¶éƒ½æˆç‚ºæˆé•·æ©Ÿæœƒã€‚é€™æ­£é«”ç¾äº†å¥‡ç¾é†«é™¢ã€Œäººæœ¬ã€å‰µæ–°ã€å“è¶Šã€çš„æ ¸å¿ƒåƒ¹å€¼ã€‚",
                    incorrect: "çœŸæ­£çš„æ”¹å–„éœ€è¦ç³»çµ±æ€§æ–¹æ³•å’Œæ–‡åŒ–è®Šé©ã€‚å–®é»æ”¹å–„æˆ–è¢«å‹•ç­‰å¾…éƒ½ç„¡æ³•å»ºç«‹æŒçºŒæ”¹å–„çš„æ©Ÿåˆ¶ã€‚TRMå¼·èª¿ä¸»å‹•é ˜å°å’Œç³»çµ±æ€ç¶­ã€‚"
                },
                reference: "å¥‡ç¾é†«é™¢å“è³ªæ”¹å–„åŸå‰‡ï¼šé‹ç”¨PDCAç§‘å­¸æ–¹æ³•ï¼Œå»ºç«‹å­¸ç¿’å‹çµ„ç¹”ï¼Œè®“æ¯å€‹åŒä»éƒ½æˆç‚ºå“è³ªæ”¹å–„çš„æ¨å‹•è€…ã€‚",
                visual: `
                    <div class="highlight-box">
                        <h4>ğŸ”„ PDCAæŒçºŒæ”¹å–„å¾ªç’°</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                            <div style="background: #eff6ff; padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <strong>Plan è¨ˆç•«</strong><br>
                                â€¢ é‡æ–°è¨­è¨ˆå®‰å…¨æª¢æ ¸è¡¨<br>
                                â€¢ å»ºç«‹æ¨™æº–æºé€šæµç¨‹<br>
                                â€¢ è¨­å®šæˆæ•ˆæŒ‡æ¨™
                            </div>
                            <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; border-left: 4px solid #16a34a;">
                                <strong>Do åŸ·è¡Œ</strong><br>
                                â€¢ å°è¦æ¨¡è©¦è¡Œ<br>
                                â€¢ åœ˜éšŠè¨“ç·´<br>
                                â€¢ æ”¶é›†åé¥‹
                            </div>
                            <div style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                                <strong>Check æª¢æ ¸</strong><br>
                                â€¢ ç›£æ¸¬å®‰å…¨æŒ‡æ¨™<br>
                                â€¢ åˆ†ææˆæ•ˆæ•¸æ“š<br>
                                â€¢ è­˜åˆ¥æ”¹å–„é»
                            </div>
                            <div style="background: #faf5ff; padding: 15px; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                                <strong>Action è¡Œå‹•</strong><br>
                                â€¢ æ¨™æº–åŒ–æµç¨‹<br>
                                â€¢ åˆ†äº«æœ€ä½³å¯¦å‹™<br>
                                â€¢ æŒçºŒç›£æ¸¬
                            </div>
                        </div>
                        <p style="text-align: center; margin-top: 15px; font-weight: bold; color: #1e40af;">
                            "æŒçºŒæ”¹å–„ï¼Œæ°¸ç„¡æ­¢å¢ƒ"
                        </p>
                    </div>
                `
            }
        ];

        // AI å°è©±ç›¸é—œåŠŸèƒ½
        const aiResponses = {
            "SBAR": "SBARæ˜¯é†«ç™‚æºé€šçš„é»ƒé‡‘æ¨™æº–ï¼S(Situation)æè¿°ç¾æ³ã€B(Background)æä¾›èƒŒæ™¯ã€A(Assessment)å°ˆæ¥­è©•ä¼°ã€R(Recommendation)å»ºè­°è¡Œå‹•ã€‚é€™æ¨£çš„çµæ§‹åŒ–æºé€šå¯ä»¥æ¸›å°‘90%çš„é†«ç™‚éŒ¯èª¤å“¦ï¼",
            "é›™é‡ç¢ºèª": "é›™é‡ç¢ºèªæ˜¯TRMçš„æ ¸å¿ƒå®‰å…¨æ©Ÿåˆ¶ï¼å°±åƒé£›æ©Ÿèµ·é£›å‰çš„å®‰å…¨æª¢æŸ¥ï¼Œé—œéµåƒæ•¸è®Šæ›´éœ€è¦ï¼šç¨ç«‹é©—è­‰â†’Read Backç¢ºèªâ†’è¨˜éŒ„æ™‚é–“â†’æœ€å¾Œæª¢æŸ¥ã€‚å¤šä¸€æ¬¡ç¢ºèªï¼Œå°‘ä¸€æ¬¡é¢¨éšªï¼",
            "CUS": "CUSæ˜¯è¡¨é”å®‰å…¨é—œåˆ‡çš„å¥½å·¥å…·ï¼C(Concern)å®¢è§€æè¿°ã€U(Uncomfortable)è¡¨é”æ“”æ†‚ã€S(Safety)æå‡ºå»ºè­°ã€‚é€™æ¨£æ—¢èƒ½ä¿è­·ç—…äººå®‰å…¨ï¼Œåˆèƒ½ç¶­è­·åŒäº‹é—œä¿‚ã€‚è¨˜ä½ï¼šæ¯å€‹äººéƒ½æ˜¯å®‰å…¨å®ˆè­·è€…ï¼",
            "ABC": "ABCæ˜¯ç·Šæ€¥è™•ç†çš„å„ªå…ˆåºåŸå‰‡ï¼A(Airway)æ°£é“ã€B(Breathing)å‘¼å¸ã€C(Circulation)å¾ªç’°ã€‚åœ¨å¤šé‡å¨è„…ä¸‹ï¼Œæ°¸é å…ˆè™•ç†å¨è„…ç”Ÿå‘½çš„å•é¡Œï¼Œå†è™•ç†æ¬¡è¦å•é¡Œã€‚ç”Ÿå‘½ç¬¬ä¸€ï¼",
            "é–‰ç’°æºé€š": "é–‰ç’°æºé€šç¢ºä¿è¨Šæ¯æº–ç¢ºå‚³é”ï¼æµç¨‹æ˜¯ï¼šæ¥æ”¶é†«å›‘â†’Read Backé‡è¤‡â†’ç²å¾—ç¢ºèªâ†’åŸ·è¡Œâ†’å›å ±å®Œæˆâ†’å†æ¬¡ç¢ºèªã€‚ç‰¹åˆ¥åœ¨ç·Šæ€¥ç‹€æ³ä¸‹ï¼Œé€™èƒ½é¿å…è‡´å‘½éŒ¯èª¤ï¼",
            "é€²é£Ÿå®‰å…¨": "NIVç—…äººé€²é£Ÿæ˜¯é«˜é¢¨éšªæ´»å‹•ï¼éœ€è¦å®Œæ•´è©•ä¼°ï¼šç”Ÿç†æŒ‡æ¨™(SpO2â‰¥92% room air 15åˆ†é˜)ã€åŠŸèƒ½è©•ä¼°(GCSã€ååš¥)ã€ç’°å¢ƒæº–å‚™(è¨­å‚™ã€äººå“¡)ã€åœ˜éšŠç¢ºèªã€‚å®‰å…¨ç¬¬ä¸€ï¼Œé é˜²å—†å’³ï¼",
            "RCA": "RCAæ ¹æœ¬åŸå› åˆ†æçš„ç²¾ç¥æ˜¯ã€Œè²¬æ€ªç³»çµ±è€Œéå€‹äººã€ï¼è¦ç³»çµ±æ€§åˆ†æï¼šç¨‹åºâ†’åŸ·è¡Œâ†’ç’°å¢ƒâ†’æºé€šâ†’è¨­å‚™â†’äººå“¡â†’çµ„ç¹”ã€‚æ‰¾å‡ºçœŸæ­£çš„ç³»çµ±å¼±é»ï¼Œæ‰èƒ½æœ‰æ•ˆé é˜²å†ç™¼ç”Ÿï¼",
            "PDCA": "PDCAæ˜¯æŒçºŒæ”¹å–„çš„ç§‘å­¸æ–¹æ³•ï¼Planè¨ˆç•«â†’DoåŸ·è¡Œâ†’Checkæª¢æ ¸â†’Actionè¡Œå‹•ã€‚é€éå¾ªç’°æ”¹å–„ï¼Œå»ºç«‹å­¸ç¿’å‹çµ„ç¹”æ–‡åŒ–ã€‚è¨˜ä½ï¼šæŒçºŒæ”¹å–„ï¼Œæ°¸ç„¡æ­¢å¢ƒï¼"
        };

        // åˆå§‹åŒ–
        function initializeApp() {
            showTab('home');
            loadLearningHistory();
        }

        // é ç±¤åˆ‡æ›
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            document.getElementById('nivCourse').style.display = 'none';
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName + 'Tab').style.display = 'block';
            event.target.classList.add('active');
            
            if (tabName === 'progress') {
                updateProgressTab();
            }
        }

        // è¼‰å…¥å­¸ç¿’æ­·ç¨‹
        function loadLearningHistory() {
            const saved = localStorage.getItem('learningHistory');
            if (saved) {
                learningHistory = JSON.parse(saved);
            }
        }

        // æ›´æ–°å­¸ç¿’æ­·ç¨‹é é¢
        function updateProgressTab() {
            const progressContent = document.getElementById('progressContent');
            const allRecords = [];
            
            // æ”¶é›†æ‰€æœ‰ä½¿ç”¨è€…çš„å­¸ç¿’è¨˜éŒ„
            for (const userId in learningHistory) {
                learningHistory[userId].forEach(record => {
                    allRecords.push({...record, userId});
                });
            }
            
            if (allRecords.length === 0) {
                progressContent.innerHTML = `
                    <p style="color: #6b7280; text-align: center; margin: 40px 0;">
                        å°šç„¡å­¸ç¿’è¨˜éŒ„ï¼Œè«‹å…ˆå®Œæˆå­¸ç¿’æ¡ˆä¾‹ä»¥å»ºç«‹å­¸ç¿’æ­·ç¨‹ã€‚
                    </p>
                `;
                return;
            }
            
            // æŒ‰æ™‚é–“æ’åºï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
            allRecords.sort((a, b) => b.timestamp - a.timestamp);
            
            let historyHtml = '<h3 style="margin-bottom: 20px;">ğŸ“ˆ å…¨éƒ¨å­¸ç¿’ç´€éŒ„</h3>';
            
            allRecords.forEach(record => {
                const scoreClass = record.percentage >= 90 ? 'score-excellent' : 
                                 record.percentage >= 80 ? 'score-good' : 'score-needs-improvement';
                const statusText = record.percentage >= 80 ? 'é€šé' : 'éœ€é‡ä¿®';
                
                historyHtml += `
                    <div class="history-item">
                        <div class="history-header">
                            <div class="history-title">${record.courseName}</div>
                            <div class="history-date">${record.completedDate}</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="margin-bottom: 5px;"><strong>å­¸å“¡ï¼š</strong>${record.userId}</div>
                                <div class="history-score ${scoreClass}">${record.score}/${record.totalQuestions} é¡Œ (${record.percentage}%)</div>
                                <div style="font-size: 0.9em; color: #6b7280;">ç‹€æ…‹ï¼š${statusText}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            progressContent.innerHTML = historyHtml;
        }

        // èª²ç¨‹ç›¸é—œåŠŸèƒ½
        function startCourse(courseType) {
            if (courseType === 'niv') {
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.style.display = 'none';
                });
                document.getElementById('nivCourse').style.display = 'block';
                document.getElementById('courseIntro').style.display = 'block';
                resetQuizState();
            }
        }

        function backToHome() {
            document.getElementById('nivCourse').style.display = 'none';
            document.getElementById('homeTab').style.display = 'block';
        }

        function backToIntro() {
            document.getElementById('caseBackground').style.display = 'none';
            document.getElementById('courseIntro').style.display = 'block';
        }

        function startLearning() {
            document.getElementById('courseIntro').style.display = 'none';
            document.getElementById('caseBackground').style.display = 'block';
        }

        function startQuiz() {
            document.getElementById('caseBackground').style.display = 'none';
            document.getElementById('quizSection').style.display = 'block';
            loadQuestion();
        }

        // é‡ç½®æ¸¬é©—ç‹€æ…‹
        function resetQuizState() {
            currentQuestion = 0;
            score = 0;
            answers = [];
            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('quizSection').style.display = 'none';
            
            // æ¸…ç©ºèŠå¤©è¨˜éŒ„
            document.getElementById('chatMessages').innerHTML = `
                <div class="chat-message ai">
                    æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„AIå­¸ç¿’åŠ©æ‰‹ã€‚å¦‚æœæ‚¨å°é€™é“é¡Œç›®æœ‰ä»»ä½•ç–‘å•ï¼Œæˆ–æƒ³äº†è§£æ›´å¤šç›¸é—œçŸ¥è­˜ï¼Œè«‹éš¨æ™‚æå•ï¼
                </div>
            `;
        }

        // è¼‰å…¥å•é¡Œ
        function loadQuestion() {
            const question = quizData[currentQuestion];
            const questionCard = document.getElementById('questionCard');
            
            questionCard.innerHTML = `
                <div class="question-header">
                    <div class="question-number">å•é¡Œ ${currentQuestion + 1} / 8</div>
                    <div class="question-type">${question.type}</div>
                </div>
                
                ${question.scenario ? `
                    <div class="scenario-box">
                        <h4>ğŸ“‹ æƒ…å¢ƒ</h4>
                        <p>${question.scenario}</p>
                    </div>
                ` : ''}
                
                <div class="question-text">${question.question}</div>
                
                <div class="options" id="optionsContainer">
                    ${question.options.map((option, index) => `
                        <div class="option" onclick="selectAnswer(${index})">${option}</div>
                    `).join('')}
                </div>
                
                ${question.visual ? `
                    <div class="visual-aid">
                        <h4>ğŸ“Š è¼”åŠ©è³‡è¨Š</h4>
                        ${question.visual}
                    </div>
                ` : ''}
            `;
            
            // æ›´æ–°é€²åº¦è³‡è¨Š
            document.getElementById('progressInfo').textContent = `å•é¡Œ ${currentQuestion + 1} / 8`;
        }

        // é¸æ“‡ç­”æ¡ˆ
        function selectAnswer(selectedIndex) {
            const question = quizData[currentQuestion];
            const isCorrect = selectedIndex === question.correct;
            
            // è¨˜éŒ„ç­”æ¡ˆ
            answers.push({
                question: currentQuestion + 1,
                selected: selectedIndex,
                correct: question.correct,
                isCorrect: isCorrect
            });
            
            if (isCorrect) {
                score++;
            }
            
            // åœç”¨æ‰€æœ‰é¸é …ä¸¦é¡¯ç¤ºçµæœ
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                option.classList.add('disabled');
                option.onclick = null;
                if (index === selectedIndex) {
                    option.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
                if (index === question.correct && !isCorrect) {
                    option.classList.add('correct');
                }
            });
            
            // é¡¯ç¤ºå›é¥‹
            showFeedback(isCorrect, question);
        }

        // é¡¯ç¤ºå›é¥‹
        function showFeedback(isCorrect, question) {
            const modal = document.getElementById('modal');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalText = document.getElementById('modalText');
            const modalReference = document.getElementById('modalReference');
            
            modalIcon.textContent = isCorrect ? 'âœ…' : 'âŒ';
            modalTitle.textContent = isCorrect ? 'å›ç­”æ­£ç¢ºï¼' : 'å›ç­”éŒ¯èª¤';
            modalTitle.className = `modal-title ${isCorrect ? 'correct' : 'incorrect'}`;
            modalText.innerHTML = isCorrect ? question.feedback.correct : question.feedback.incorrect;
            modalReference.innerHTML = `<strong>åƒè€ƒä¾æ“šï¼š</strong> ${question.reference}`;
            
            modal.style.display = 'block';
        }

        // ä¸‹ä¸€é¡Œ
        function nextQuestion() {
            document.getElementById('modal').style.display = 'none';
            
            currentQuestion++;
            
            if (currentQuestion < quizData.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        // é¡¯ç¤ºçµæœ
        function showResults() {
            document.getElementById('quizSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
            
            const percentage = Math.round((score / quizData.length) * 100);
            const scoreDisplay = document.getElementById('scoreDisplay');
            const resultsContent = document.getElementById('resultsContent');
            
            let performanceLevel = '';
            let performanceClass = '';
            let feedback = '';
            
            if (percentage >= 90) {
                performanceLevel = 'å„ªç§€ï¼';
                performanceClass = 'excellent';
                feedback = 'æ‚¨å°éä¾µè¥²æ€§å‘¼å¸å™¨çš„åœ˜éšŠç…§è­·ç®¡ç†æœ‰æ·±å…¥çš„äº†è§£ï¼';
            } else if (percentage >= 80) {
                performanceLevel = 'é€šéï¼';
                performanceClass = 'good';
                feedback = 'æ‚¨å·²é”åˆ°åŠæ ¼æ¨™æº–ï¼ŒæŒæ¡äº†å¤§éƒ¨åˆ†é‡è¦æ¦‚å¿µï¼';
            } else {
                performanceLevel = 'éœ€è¦åŠ å¼·';
                performanceClass = 'needs-improvement';
                feedback = 'å»ºè­°é‡æ–°å­¸ç¿’ç¨‹åºæ›¸å…§å®¹ï¼Œä¸¦é‡è¤‡ç·´ç¿’ã€‚åŠæ ¼åˆ†æ•¸ç‚º80åˆ†ã€‚';
            }
            
            scoreDisplay.className = `score-display ${performanceClass}`;
            scoreDisplay.innerHTML = `
                <div style="font-size: 1.2em; margin-bottom: 15px;">${performanceLevel}</div>
                <div>æ‚¨çš„æˆç¸¾ï¼š${score} / ${quizData.length} é¡Œ</div>
                <div>ç­”å°ç‡ï¼š${percentage}%</div>
            `;
            
            let buttonsHtml = '';
            if (percentage >= 80) {
                buttonsHtml = `
                    <button class="btn btn-success" onclick="showCreditModal()">ç™»éŒ„å­¸åˆ†</button>
                    <button class="btn btn-primary" onclick="reviewAnswers()">æŸ¥çœ‹è©³ç´°è§£æ</button>
                    <button class="btn" onclick="backToHome()" style="background: #6b7280; color: white;">è¿”å›èª²ç¨‹åˆ—è¡¨</button>
                `;
            } else {
                buttonsHtml = `
                    <button class="btn btn-primary" onclick="reviewAnswers()">æŸ¥çœ‹è©³ç´°è§£æ</button>
                    <button class="btn btn-primary" onclick="resetQuizState(); startQuiz()">é‡æ–°æ¸¬é©—</button>
                    <button class="btn" onclick="backToHome()" style="background: #6b7280; color: white;">è¿”å›èª²ç¨‹åˆ—è¡¨</button>
                `;
            }
            
            resultsContent.innerHTML = `
                <p style="font-size: 1.1em; margin-bottom: 30px;">${feedback}</p>
                
                <div class="highlight-box">
                    <h4>ğŸ“š é‡é»å›é¡§</h4>
                    <p>æœ¬æ¡ˆä¾‹æ¶µè“‹äº†NIVç…§è­·çš„æ ¸å¿ƒè¦ç´ ï¼š</p>
                    <ul style="text-align: left; margin: 15px 0;">
                        <li><strong>åœ˜éšŠè³‡æºç®¡ç†(TRM)</strong>ï¼šæœ‰æ•ˆçš„æºé€šèˆ‡å”èª¿</li>
                        <li><strong>å°ˆæ¥­åˆ†å·¥</strong>ï¼šé†«å¸«æ±ºç­–ã€RTæ“ä½œã€RNç›£è­·</li>
                        <li><strong>ç—…äººå®‰å…¨</strong>ï¼šç‰¹åˆ¥æ˜¯é€²é£Ÿæ™‚çš„é–‹é—œæ©Ÿç¨‹åº</li>
                        <li><strong>å“è³ªç…§è­·</strong>ï¼šå…¨é¢ç›£æ¸¬èˆ‡é¢¨éšªç®¡ç†</li>
                    </ul>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    ${buttonsHtml}
                </div>
            `;
        }

        // é¡¯ç¤ºå­¸åˆ†ç™»éŒ„è¦–çª—
        function showCreditModal() {
            document.getElementById('creditModal').style.display = 'block';
        }

        // æäº¤å­¸åˆ†ç™»éŒ„
        function submitCredit() {
            const employeeId = document.getElementById('creditEmployeeId').value.trim();
            
            if (!employeeId) {
                alert('è«‹è¼¸å…¥äººäº‹è™Ÿç¢¼');
                return;
            }
            
            if (employeeId.length < 3) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„äººäº‹è™Ÿç¢¼');
                return;
            }
            
            saveProgress(employeeId);
            document.getElementById('creditModal').style.display = 'none';
            
            alert('å­¸åˆ†ç™»éŒ„æˆåŠŸï¼æ‚¨çš„å­¸ç¿’è¨˜éŒ„å·²ä¿å­˜ã€‚');
        }

        // è·³éå­¸åˆ†ç™»éŒ„
        function skipCredit() {
            document.getElementById('creditModal').style.display = 'none';
        }

        // å„²å­˜å­¸ç¿’é€²åº¦
        function saveProgress(employeeId) {
            const percentage = Math.round((score / quizData.length) * 100);
            const now = new Date();
            
            const learningRecord = {
                courseName: 'éä¾µè¥²æ€§å‘¼å¸å™¨ (NIV) é†«ç™‚åœ˜éšŠç…§è­·å­¸ç¿’',
                score: score,
                totalQuestions: quizData.length,
                percentage: percentage,
                answers: answers,
                completedDate: now.toLocaleString('zh-TW'),
                timestamp: now.getTime()
            };
            
            // ç¢ºä¿ç”¨æˆ¶æœ‰å­¸ç¿’æ­·ç¨‹é™£åˆ—
            if (!learningHistory[employeeId]) {
                learningHistory[employeeId] = [];
            }
            
            learningHistory[employeeId].push(learningRecord);
            
            // å„²å­˜åˆ°localStorage
            localStorage.setItem('learningHistory', JSON.stringify(learningHistory));
        }

        // æŸ¥çœ‹è©³ç´°è§£æ
        function reviewAnswers() {
            let reviewHtml = '<h3>ğŸ“‹ ç­”é¡Œè©³ç´°è§£æ</h3>';
            
            answers.forEach((answer, index) => {
                const question = quizData[index];
                const statusIcon = answer.isCorrect ? 'âœ…' : 'âŒ';
                const statusColor = answer.isCorrect ? '#16a34a' : '#dc2626';
                
                reviewHtml += `
                    <div style="border: 2px solid ${statusColor}; border-radius: 10px; padding: 20px; margin: 20px 0; background: ${answer.isCorrect ? '#f0fdf4' : '#fef2f2'};">
                        <h4 style="color: ${statusColor};">${statusIcon} å•é¡Œ ${index + 1}ï¼š${question.type}</h4>
                        <p><strong>æ‚¨çš„ç­”æ¡ˆï¼š</strong>${question.options[answer.selected]}</p>
                        <p><strong>æ­£ç¢ºç­”æ¡ˆï¼š</strong>${question.options[answer.correct]}</p>
                        <p><strong>è§£æï¼š</strong>${answer.isCorrect ? question.feedback.correct : question.feedback.incorrect}</p>
                        <p style="font-size: 0.9em; color: #6b7280;"><strong>åƒè€ƒï¼š</strong>${question.reference}</p>
                    </div>
                `;
            });
            
            const percentage = Math.round((score / quizData.length) * 100);
            let buttonsHtml = '';
            if (percentage >= 80) {
                buttonsHtml = `
                    <button class="btn btn-primary" onclick="showResults()">è¿”å›çµæœ</button>
                    <button class="btn btn-success" onclick="showCreditModal()">ç™»éŒ„å­¸åˆ†</button>
                    <button class="btn" onclick="backToHome()" style="background: #6b7280; color: white;">è¿”å›èª²ç¨‹åˆ—è¡¨</button>
                `;
            } else {
                buttonsHtml = `
                    <button class="btn btn-primary" onclick="showResults()">è¿”å›çµæœ</button>
                    <button class="btn btn-primary" onclick="resetQuizState(); startQuiz()">é‡æ–°æ¸¬é©—</button>
                    <button class="btn" onclick="backToHome()" style="background: #6b7280; color: white;">è¿”å›èª²ç¨‹åˆ—è¡¨</button>
                `;
            }
            
            reviewHtml += `
                <div style="text-align: center; margin-top: 30px;">
                    ${buttonsHtml}
                </div>
            `;
            
            document.getElementById('resultsContent').innerHTML = reviewHtml;
        }

        // AI èŠå¤©åŠŸèƒ½
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // æ·»åŠ ç”¨æˆ¶è¨Šæ¯
            addChatMessage(message, 'user');
            
            // æ¸…ç©ºè¼¸å…¥æ¡†
            input.value = '';
            
            // ç”ŸæˆAIå›æ‡‰
            setTimeout(() => {
                const aiResponse = generateAIResponse(message);
                addChatMessage(aiResponse, 'ai');
            }, 500);
        }

        function addChatMessage(message, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}`;
            messageDiv.textContent = message;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function generateAIResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            // æª¢æŸ¥é—œéµå­—ä¸¦æä¾›ç›¸æ‡‰å›æ‡‰
            for (const keyword in aiResponses) {
                if (message.includes(keyword.toLowerCase())) {
                    return aiResponses[keyword];
                }
            }
            
            // æ ¹æ“šç•¶å‰å•é¡Œé¡å‹æä¾›å›æ‡‰
            if (currentQuestion < quizData.length) {
                const currentType = quizData[currentQuestion].type;
                
                if (currentType.includes('SBAR')) {
                    return aiResponses['SBAR'];
                } else if (currentType.includes('é›™é‡ç¢ºèª')) {
                    return aiResponses['é›™é‡ç¢ºèª'];
                } else if (currentType.includes('CUS')) {
                    return aiResponses['CUS'];
                } else if (currentType.includes('å¤šé‡å®‰å…¨å¨è„…')) {
                    return aiResponses['ABC'];
                } else if (currentType.includes('é–‰ç’°æºé€š')) {
                    return aiResponses['é–‰ç’°æºé€š'];
                } else if (currentType.includes('é€²é£Ÿ')) {
                    return aiResponses['é€²é£Ÿå®‰å…¨'];
                } else if (currentType.includes('RCA')) {
                    return aiResponses['RCA'];
                } else if (currentType.includes('PDCA')) {
                    return aiResponses['PDCA'];
                }
            }
            
            // é€šç”¨å›æ‡‰
            const generalResponses = [
                "é€™æ˜¯ä¸€å€‹å¾ˆå¥½çš„å•é¡Œï¼è®“æˆ‘ä¾†è§£é‡‹ä¸€ä¸‹...",
                "æ ¹æ“šTRMçš„æ ¸å¿ƒåŸå‰‡ï¼Œæˆ‘å»ºè­°æ‚¨æ€è€ƒä¸€ä¸‹åœ˜éšŠå”ä½œå’Œå®‰å…¨ç®¡ç†çš„é‡è¦æ€§ã€‚",
                "NIVç…§è­·æ¶‰åŠå¤šå€‹é¢å‘ï¼ŒåŒ…æ‹¬æŠ€è¡“æ“ä½œã€åœ˜éšŠæºé€šå’Œç—…äººå®‰å…¨ï¼Œæ‚¨æƒ³äº†è§£å“ªå€‹éƒ¨åˆ†å‘¢ï¼Ÿ",
                "åœ¨é†«ç™‚ç…§è­·ä¸­ï¼Œä»»ä½•æ“ä½œéƒ½è¦ä»¥ç—…äººå®‰å…¨ç‚ºå„ªå…ˆè€ƒé‡ã€‚æ‚¨å°é€™é“é¡Œç›®çš„å“ªå€‹éƒ¨åˆ†æœ‰ç–‘å•ï¼Ÿ",
                "TRMå¼·èª¿çš„æ˜¯ç³»çµ±æ€§æ€ç¶­å’Œåœ˜éšŠå”ä½œï¼Œè®“æˆ‘å€‘ä¸€èµ·ä¾†åˆ†æé€™å€‹æƒ…å¢ƒ..."
            ];
            
            return generalResponses[Math.floor(Math.random() * generalResponses.length)];
        }

        // é˜²æ­¢æ„å¤–é›¢é–‹
        window.addEventListener('beforeunload', function(e) {
            if (currentQuestion > 0 && currentQuestion < quizData.length) {
                e.preventDefault();
                e.returnValue = '';
                return 'æ‚¨çš„å­¸ç¿’é€²åº¦å°‡æœƒéºå¤±ï¼Œç¢ºå®šè¦é›¢é–‹å—ï¼Ÿ';
            }
        });

        // é»æ“Šæ¨¡æ…‹æ¡†å¤–éƒ¨é—œé–‰
        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            const creditModal = document.getElementById('creditModal');
            
            if (event.target === modal) {
                return false; // ä¸å…è¨±åœ¨æ¸¬é©—æœŸé–“é—œé–‰
            }
            if (event.target === creditModal) {
                creditModal.style.display = 'none';
            }
        }

        // åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
    </script>
</body>
</html>
